L1 <- Lposterior(chain.wPE,tree, burnin=0.3)
L2 <- Lposterior(chain.wPE.sim2, tree, burnin=.3)
plot(L1$pp, L2$pp, ylab="Simulated data under PE Posterior Probabilities", xlab="True data Posterior Probabilities",
main="Posterior probabilities for branches for RJ partition", xlim=c(0,1), ylim=c(0,1), pch=21, bg="gray90", cex=1.5)
text(0.85, 0.1, "Phrynosoma")
abline(0,1)
par(mfrow=c(2,2))
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, setNames(viridis::viridis(3), 1:3), fsize=0.4, main="PE Hypothesis", spread.labels=FALSE)
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, cols=setNames(viridis::viridis(3), 1:3), fsize=0.4, main="PE Hypothesis", spread.labels=FALSE)
cols=setNames(viridis::viridis(3), 1:3)
cols
par(mfrow=c(2,2))
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, cols=setNames(viridis::viridis(3), 1:3), fsize=0.4, main="PE Hypothesis", spread.labels=FALSE)
pars2simmap(H.PE, td$phy)$tr$maps
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), 1:3), fsize=0.4, main="PE Hypothesis", spread.labels=FALSE)
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), 3:1), fsize=0.4, main="PE Hypothesis", spread.labels=FALSE)
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(1,3,2)), fsize=0.4, main="PE Hypothesis", spread.labels=FALSE)
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(2, 3,1)), fsize=0.4, main="PE Hypothesis", spread.labels=FALSE)
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(1, 3,2)), fsize=0.4, main="PE Hypothesis", spread.labels=FALSE)
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(1, 2,3)), fsize=0.4, main="PE Hypothesis", spread.labels=FALSE)
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(2, 1,3)), fsize=0.4, main="PE Hypothesis", spread.labels=FALSE)
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(3, 2, 1)), fsize=0.4, main="PE Hypothesis", spread.labels=FALSE)
par(mfrow=c(2,2))
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(3, 2, 1)), fsize=0.4, main="PE Hypothesis", spread.labels=FALSE)
plot(density(rbeta(length(postburn)*20, 0.8, 0.8), bw = 0.05), ylim=c(0,5), lty=2, main="Weight to PE Hypothesis")
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
polygon(density(1-chain.wPE$w[postburn], bw = 0.05), col=cols[1])
polygon(density(1-chain.wPE.sim1$w[postburn], bw = 0.05), col=cols[2])
polygon(density(1-chain.wPE.sim2$w[postburn], bw = 0.05), col=cols[3])
legend(-0.15, 5, legend = c("Prior","Scales data", "Simulated data, phrynos only", "Simulated data under PE Hypothesis"),
pch=rep(22,4) , pt.bg=c("black", cols),lty=c(2,NA,NA,NA),  pt.cex=c(0,2,2,2))
L1 <- Lposterior(chain.wPE,tree, burnin=0.3)
L2 <- Lposterior(chain.wPE.sim2, tree, burnin=.3)
plot(L1$pp, L2$pp, ylab="Simulated data under PE Posterior Probabilities", xlab="True data Posterior Probabilities",
main="Posterior probabilities for branches for RJ partition", xlim=c(0,1), ylim=c(0,1), pch=21, bg="gray90", cex=1.5)
text(0.85, 0.1, "Phrynosoma")
abline(0,1)
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(2,3, 1)), fsize=0.4, main="PE Hypothesis", spread.labels=FALSE)
par(mfrow=c(2,2))
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(2,3, 1)), fsize=0.4, main="PE Hypothesis", spread.labels=FALSE)
plot(density(rbeta(length(postburn)*20, 0.8, 0.8), bw = 0.05), ylim=c(0,5), lty=2, main="Weight to PE Hypothesis")
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
polygon(density(1-chain.wPE$w[postburn], bw = 0.05), col=cols[1])
polygon(density(1-chain.wPE.sim1$w[postburn], bw = 0.05), col=cols[2])
polygon(density(1-chain.wPE.sim2$w[postburn], bw = 0.05), col=cols[3])
legend(-0.15, 5, legend = c("Prior","Scales data", "Simulated data, phrynos only", "Simulated data under PE Hypothesis"),
pch=rep(22,4) , pt.bg=c("black", cols),lty=c(2,NA,NA,NA),  pt.cex=c(0,2,2,2))
L1 <- Lposterior(chain.wPE,tree, burnin=0.3)
L2 <- Lposterior(chain.wPE.sim2, tree, burnin=.3)
plot(L1$pp, L2$pp, ylab="Simulated data under PE Posterior Probabilities", xlab="True data Posterior Probabilities",
main="Posterior probabilities for branches for RJ partition", xlim=c(0,1), ylim=c(0,1), pch=21, bg="gray90", cex=1.5)
text(0.85, 0.1, "Phrynosoma")
abline(0,1)
mcmc.wPE$run(200000)
mcmc.wPE$run(200000)
chain.wPE <- mcmc.wPE$load()
par(mfrow=c(2,2))
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(2,3, 1)), fsize=0.5, main="PE Hypothesis")
hist(rbeta(length(postburn)*20, 0.8, 0.8), ylim=c(0,5), lty=2, main="Weight to PE Hypothesis")
hist(rbeta(length(postburn)*20, 0.8, 0.8), lty=2, main="Weight to PE Hypothesis")
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist((1-chain.wPE$w[postburn]), col=cols[1])
hist(rbeta(length(postburn)*20, 0.8, 0.8), lty=2, main="Weight to PE Hypothesis", breaks=c(0,1,0.05))
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist((1-chain.wPE$w[postburn]), col=cols[1], add=TRUE, breaks=c(0,1,0.05))
hist(rbeta(length(postburn)*20, 0.8, 0.8), lty=2, main="Weight to PE Hypothesis", breaks=seq(0,1,0.05))
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist((1-chain.wPE$w[postburn]), col=cols[1], add=TRUE, breaks=seq(0,1,0.05))
hist(rbeta(length(postburn), 0.8, 0.8), lty=2, main="Weight to PE Hypothesis", breaks=seq(0,1,0.05))
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist((1-chain.wPE$w[postburn]), col=cols[1], add=TRUE, breaks=seq(0,1,0.05))
hist(rbeta(length(postburn), 0.8, 0.8), lty=2, main="Weight to PE Hypothesis", breaks=seq(0,1,0.05))
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist((1-chain.wPE$w[postburn]), col=cols[1], add=TRUE, breaks=seq(0,1,0.05))
hist(1-chain.wPE.sim1$w[postburn]), col=cols[2], add=TRUE, breaks=seq(0,1,0.05))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.05))
hist(rbeta(length(postburn), 0.8, 0.8), lty=2, main="Weight to PE Hypothesis", breaks=seq(0,1,0.05))
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.05))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.05))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.05))
hist(rbeta(length(postburn), 0.8, 0.8), lty=2, main="Weight to PE Hypothesis", breaks=seq(0,1,0.05))
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
plot(chain.wPE$w)
mcmc.wPE$run(200000)
mcmc.wPE$run(200000)
chain.wPE <- mcmc.wPE$load()
postburn <- floor(0.3*length(chain.wPE$gen)):length(chain.wPE$gen)
par(mfrow=c(2,2))
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(2,3, 1)), fsize=0.5, main="PE Hypothesis")
hist(rbeta(length(postburn)*3, 0.8, 0.8), lty=2, main="Weight to PE Hypothesis", breaks=seq(0,1,0.05))
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
hist(rbeta(length(postburn)*1, 0.8, 0.8), lty=2, main="Weight to PE Hypothesis", breaks=seq(0,1,0.05))
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
hist(rbeta(length(postburn)*1, 0.8, 0.8), lty=2, main="Weight to PE Hypothesis", breaks=seq(0,1,0.025))
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
hist(rbeta(length(postburn)*1, 0.8, 0.8), lty=2, main="Weight to PE Hypothesis", breaks=seq(0,1,0.025), ylim=c(0, 2500))
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
hist(rbeta(length(postburn)*1, 0.8, 0.8), lty=2, main="Weight to PE Hypothesis", breaks=seq(0,1,0.025), ylim=c(0, 3000))
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
mcmc.wPE.sim1$run(200000)
mcmc.wPE.sim2$run(200000)
mcmc.wPE.sim2$run(200000)
chain.wPE <- mcmc.wPE$load()
chain.wPE.sim1 <- mcmc.wPE.sim1$load()
chain.wPE.sim2 <- mcmc.wPE.sim2$load()
postburn <- floor(0.3*length(chain.wPE$gen)):length(chain.wPE$gen)
par(mfrow=c(2,2))
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(2,3, 1)), fsize=0.5, main="PE Hypothesis")
hist(rbeta(length(postburn)*1, 0.8, 0.8), lty=2, main="Weight to PE Hypothesis", breaks=seq(0,1,0.025), ylim=c(0, 3000))
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
legend(-0.15, 5, legend = c("Prior","Scales data", "Simulated data, phrynos only", "Simulated data under PE Hypothesis"),
pch=rep(22,4) , pt.bg=c("black", cols),lty=c(2,NA,NA,NA),  pt.cex=c(0,2,2,2))
L1 <- Lposterior(chain.wPE,tree, burnin=0.3)
L2 <- Lposterior(chain.wPE.sim2, tree, burnin=.3)
plot(L1$pp, L2$pp, ylab="Simulated data under PE Posterior Probabilities", xlab="True data Posterior Probabilities",
main="Posterior probabilities for branches for RJ partition", xlim=c(0,1), ylim=c(0,1), pch=21, bg="gray90", cex=1.5)
text(0.85, 0.1, "Phrynosoma")
abline(0,1, lty=2)
plotSimmap.mcmc(chain.wPE, burnin=0.3, pp.cutoff=0.5, pal=viridis::viridis)
plot(density(rbeta(length(postburn)*1, 0.8, 0.8), lty=2, main="Weight to PE Hypothesis", breaks=seq(0,1,0.025), ylim=c(0, 3000))
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
legend(-0.15, 5, legend = c("Prior","Scales data", "Simulated data, phrynos only", "Simulated data under PE Hypothesis"),
pch=rep(22,4) , pt.bg=c("black", cols),lty=c(2,NA,NA,NA),  pt.cex=c(0,2,2,2))
L1 <- Lposterior(chain.wPE,tree, burnin=0.3)
L2 <- Lposterior(chain.wPE.sim2, tree, burnin=.3)
plot(L1$pp, L2$pp, ylab="Simulated data under PE Posterior Probabilities", xlab="True data Posterior Probabilities",
main="Posterior probabilities for branches for RJ partition", xlim=c(0,1), ylim=c(0,1), pch=21, bg="gray90", cex=1.5)
text(0.85, 0.1, "Phrynosoma")
abline(0,1, lty=2)
plotSimmap.mcmc(chain.wPE, burnin=0.3, pp.cutoff=0.5, pal=viridis::viridis)
plot(density(rbeta(length(postburn)*1, 0.8, 0.8)), lty=2, main="Weight to PE Hypothesis", breaks=seq(0,1,0.025), ylim=c(0, 3000))
plot(density(rbeta(length(postburn)*10, 0.8, 0.8)), lty=2, main="Weight to PE Hypothesis", ylim=c(0, 3000))
plot(density(rbeta(length(postburn)*100, 0.8, 0.8)), lty=2, main="Weight to PE Hypothesis", ylim=c(0, 3000))
warnings()
plot(density(rbeta(length(postburn)*100, 0.8, 0.8)), lty=2, main="Weight to PE Hypothesis", ylim=c(0, 3000))
plot(density(rbeta(length(postburn)*1000, 0.8, 0.8)), lty=2, main="Weight to PE Hypothesis", ylim=c(0, 3000))
plot(density(rbeta(length(postburn)*10, 0.8, 0.8), bw=0.01), lty=2, main="Weight to PE Hypothesis", ylim=c(0, 3000))
plot(density(rbeta(length(postburn)*10, 0.8, 0.8), bw=0.001), lty=2, main="Weight to PE Hypothesis", ylim=c(0, 3000))
plot(density(rbeta(length(postburn)*10, 0.8, 0.8), bw=0.5), lty=2, main="Weight to PE Hypothesis", ylim=c(0, 3000))
density(rbeta(length(postburn)*10, 0.8, 0.8), bw=0.5)
qq <- density(rbeta(length(postburn)*10, 0.8, 0.8), bw=0.5)
qq$y
priorDens <- density(rbeta(length(postburn)*100, 0.8, 0.8), bw=0.5)
plot(priorDens$x, priorDens$y*3000, lty=2, main="Weight to PE Hypothesis", ylim=c(0, 3000))
priorDens <- density(rbeta(length(postburn)*100, 0.8, 0.8), bw=0.01)
plot(priorDens$x, priorDens$y*3000, lty=2, main="Weight to PE Hypothesis", ylim=c(0, 3000))
priorDens <- density(rbeta(length(postburn)*90, 0.8, 0.8), bw=0.01)
plot(priorDens$x, priorDens$y*3000, type="n", lty=2, main="Weight to PE Hypothesis", ylim=c(0, 3000))
lines(priorDens$x, priorDens$y*3000, lty=2)
priorDens <- density(rbeta(length(postburn)*90, 0.8, 0.8), bw=0.01)
plot(priorDens$x, priorDens$y*2000, type="n", lty=2, main="Weight to PE Hypothesis", ylim=c(0, 3000))
lines(priorDens$x, priorDens$y*2000, lty=2)
priorDens <- density(rbeta(length(postburn)*90, 0.8, 0.8), bw=0.01)
plot(priorDens$x, priorDens$y*2000, type="n", lty=2, main="Weight to PE Hypothesis", ylim=c(0, 3000))
lines(priorDens$x, priorDens$y*2000, lty=2)
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
priorDens <- density(rbeta(length(postburn)*90, 0.8, 0.8), bw=0.01)
plot(priorDens$x, priorDens$y*2000, type="n", lty=2, main="Weight to PE Hypothesis", ylim=c(0, 4000))
lines(priorDens$x, priorDens$y*2000, lty=2)
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
legend(-0.15, 5, legend = c("Prior","Scales data", "Simulated data, phrynos only", "Simulated data under PE Hypothesis"),
pch=rep(22,4) , pt.bg=c("black", cols),lty=c(2,NA,NA,NA),  pt.cex=c(0,2,2,2))
priorDens <- density(rbeta(length(postburn)*90, 0.8, 0.8), bw=0.01)
plot(priorDens$x, priorDens$y*2000, type="n", lty=2, main="Weight to PE Hypothesis", ylim=c(0, 5000))
lines(priorDens$x, priorDens$y*2000, lty=2)
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
legend(-0.15, 5000, legend = c("Prior","Scales data", "Simulated data, phrynos only", "Simulated data under PE Hypothesis"),
pch=rep(22,4) , pt.bg=c("black", cols),lty=c(2,NA,NA,NA),  pt.cex=c(0,2,2,2))
par(mfrow=c(2,2))
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(2,3, 1)), fsize=0.5, main="PE Hypothesis")
priorDens <- density(rbeta(length(postburn)*90, 0.8, 0.8), bw=0.01)
plot(priorDens$x, priorDens$y*2000, type="n", lty=2, main="Weight to PE Hypothesis", ylim=c(0, 6000), xlab="Weight to PE Hypothesis", ylab="Density", yaxt="n")
lines(priorDens$x, priorDens$y*2000, lty=2)
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
legend(-0.15, 5000, legend = c("Prior","Scales data", "Simulated data, phrynos only", "Simulated data under PE Hypothesis"),
pch=rep(22,4) , pt.bg=c("black", cols),lty=c(2,NA,NA,NA),  pt.cex=c(0,2,2,2))
par(mfrow=c(2,2))
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(2,3, 1)), fsize=0.5, main="PE Hypothesis")
priorDens <- density(rbeta(length(postburn)*90, 0.8, 0.8), bw=0.01)
plot(priorDens$x, priorDens$y*2000, type="n", lty=2, main="Weight to PE Hypothesis", ylim=c(0, 6000), xlab="Weight to PE Hypothesis", ylab="Density", yaxt="n")
lines(priorDens$x, priorDens$y*2000, lty=2)
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
legend(-0.15, 6000, legend = c("Prior","Scales data", "Simulated data, phrynos only", "Simulated data under PE Hypothesis"),
pch=rep(22,4) , pt.bg=c("black", cols),lty=c(2,NA,NA,NA),  pt.cex=c(0,2,2,2))
L1 <- Lposterior(chain.wPE,tree, burnin=0.3)
L2 <- Lposterior(chain.wPE.sim2, tree, burnin=.3)
plot(L1$pp, L2$pp, ylab="Simulated data under PE Posterior Probabilities", xlab="True data Posterior Probabilities",
main="Posterior probabilities for branches for RJ partition", xlim=c(0,1), ylim=c(0,1), pch=21, bg="gray90", cex=1.5)
text(0.85, 0.1, "Phrynosoma")
abline(0,1, lty=2)
plotSimmap.mcmc(chain.wPE, burnin=0.3, pp.cutoff=0.5, pal=colorRampPalette(viridis::viridis(3)[2:3]))
pdf("~/repos/pnh-ms/R/output/scales/ScalesReanalysis.pdf", height=6, width=10)
par(mfrow=c(2,2))
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(2,3, 1)), fsize=0.5, main="PE Hypothesis")
priorDens <- density(rbeta(length(postburn)*90, 0.8, 0.8), bw=0.01)
plot(priorDens$x, priorDens$y*2000, type="n", lty=2, main="Weight to PE Hypothesis", ylim=c(0, 6000), xlab="Weight to PE Hypothesis", ylab="Density", yaxt="n")
lines(priorDens$x, priorDens$y*2000, lty=2)
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
legend(-0.15, 6000, legend = c("Prior","Scales data", "Simulated data, phrynos only", "Simulated data under PE Hypothesis"),
pch=rep(22,4) , pt.bg=c("black", cols),lty=c(2,NA,NA,NA),  pt.cex=c(0,2,2,2))
L1 <- Lposterior(chain.wPE,tree, burnin=0.3)
L2 <- Lposterior(chain.wPE.sim2, tree, burnin=.3)
plot(L1$pp, L2$pp, ylab="Simulated data under PE Posterior Probabilities", xlab="True data Posterior Probabilities",
main="Posterior probabilities for branches for RJ partition", xlim=c(0,1), ylim=c(0,1), pch=21, bg="gray90", cex=1.5)
text(0.85, 0.1, "Phrynosoma")
abline(0,1, lty=2)
plotSimmap.mcmc(chain.wPE, burnin=0.3, pp.cutoff=0.5, pal=colorRampPalette(viridis::viridis(3)[c(1, 2)]))
dev.off()
pdf("~/repos/pnh-ms/R/output/scales/ScalesReanalysis.pdf", height=8, width=12)
par(mfrow=c(2,2), mar=c(5,5,0.25, 0.25))
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(2,3, 1)), fsize=0.5, main="PE Hypothesis")
priorDens <- density(rbeta(length(postburn)*90, 0.8, 0.8), bw=0.01)
plot(priorDens$x, priorDens$y*2000, type="n", lty=2, main="Weight to PE Hypothesis", ylim=c(0, 6000), xlab="Weight to PE Hypothesis", ylab="Density", yaxt="n")
lines(priorDens$x, priorDens$y*2000, lty=2)
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
legend(-0.15, 6000, legend = c("Prior","Scales data", "Simulated data, phrynos only", "Simulated data under PE Hypothesis"),
pch=rep(22,4) , pt.bg=c("black", cols),lty=c(2,NA,NA,NA),  pt.cex=c(0,2,2,2))
L1 <- Lposterior(chain.wPE,tree, burnin=0.3)
L2 <- Lposterior(chain.wPE.sim2, tree, burnin=.3)
plot(L1$pp, L2$pp, ylab="Simulated data under PE Posterior Probabilities", xlab="True data Posterior Probabilities",
main="Posterior probabilities for branches for RJ partition", xlim=c(0,1), ylim=c(0,1), pch=21, bg="gray90", cex=1.5)
text(0.85, 0.1, "Phrynosoma")
abline(0,1, lty=2)
plotSimmap.mcmc(chain.wPE, burnin=0.3, pp.cutoff=0.5, pal=colorRampPalette(viridis::viridis(3)[c(1, 2)]))
dev.off()
pdf("~/repos/pnh-ms/R/output/scales/ScalesReanalysis.pdf", height=8, width=12)
par(mfrow=c(2,2), mar=c(5,5,0.25, 0.25))
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(2,3, 1)), fsize=0.5, ylab="FG fraction", xlab="Time (my)")
priorDens <- density(rbeta(length(postburn)*90, 0.8, 0.8), bw=0.01)
plot(priorDens$x, priorDens$y*2000, type="n", lty=2, ylim=c(0, 6000), xlab="Weight to PE Hypothesis", ylab="Density", yaxt="n")
lines(priorDens$x, priorDens$y*2000, lty=2)
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
legend(-0.15, 6000, legend = c("Prior","Scales data", "Simulated data, phrynos only", "Simulated data under PE Hypothesis"),
pch=rep(22,4) , pt.bg=c("black", cols),lty=c(2,NA,NA,NA),  pt.cex=c(0,2,2,2))
L1 <- Lposterior(chain.wPE,tree, burnin=0.3)
L2 <- Lposterior(chain.wPE.sim2, tree, burnin=.3)
plot(L1$pp, L2$pp, ylab="Simulated data under PE Posterior Probabilities", xlab="Empirical data Posterior Probabilities",
xlim=c(0,1), ylim=c(0,1), pch=21, bg="gray90", cex=1.5)
text(0.85, 0.1, "Phrynosoma")
abline(0,1, lty=2)
plotSimmap.mcmc(chain.wPE, burnin=0.3, pp.cutoff=0.5, pal=colorRampPalette(viridis::viridis(3)[c(1, 2)]))
dev.off()
pdf("~/repos/pnh-ms/R/output/scales/ScalesReanalysis.pdf", height=8, width=12)
par(mfrow=c(2,2), mar=c(5,5,0.25, 0.25))
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(2,3, 1)), fsize=0.5, ylab="FG fraction", xlab="Time (my)")
priorDens <- density(rbeta(length(postburn)*90, 0.8, 0.8), bw=0.01)
plot(priorDens$x, priorDens$y*2000, type="n", lty=2, ylim=c(0, 7000), xlab="Weight to PE Hypothesis", ylab="Density", yaxt="n")
lines(priorDens$x, priorDens$y*2000, lty=2)
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
legend(0, 7000, legend = c("Prior","Scales data", "Simulated data, phrynos only", "Simulated data under PE Hypothesis"),
pch=rep(22,4) , pt.bg=c("black", cols),lty=c(2,NA,NA,NA),  pt.cex=c(0,2,2,2))
L1 <- Lposterior(chain.wPE,tree, burnin=0.3)
L2 <- Lposterior(chain.wPE.sim2, tree, burnin=.3)
plot(L1$pp, L2$pp, ylab="Simulated data under PE Posterior Probabilities", xlab="Empirical data Posterior Probabilities",
xlim=c(0,1), ylim=c(0,1), pch=21, bg="gray90", cex=1.5)
text(0.85, 0.1, "Phrynosoma")
abline(0,1, lty=2)
plotSimmap.mcmc(chain.wPE, burnin=0.3, pp.cutoff=0.5, pal=colorRampPalette(viridis::viridis(3)[c(1, 2)]))
dev.off()
pdf("~/repos/pnh-ms/R/output/scales/ScalesReanalysis.pdf", height=8, width=12)
par(mfrow=c(2,2), mar=c(5,5,0.25, 0.25))
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(2,3, 1)), fsize=0.75, ylab="FG fraction", xlab="Time (my)")
priorDens <- density(rbeta(length(postburn)*90, 0.8, 0.8), bw=0.01)
plot(priorDens$x, priorDens$y*2000, type="n", lty=2, ylim=c(0, 7000), xlab="Weight to PE Hypothesis", ylab="Density", yaxt="n")
lines(priorDens$x, priorDens$y*2000, lty=2)
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
legend(0, 7000, legend = c("Prior","Scales data", "Simulated data, phrynos only", "Simulated data under PE Hypothesis"),
pch=rep(22,4) , pt.bg=c("black", cols),lty=c(2,NA,NA,NA),  pt.cex=c(0,2,2,2))
L1 <- Lposterior(chain.wPE,tree, burnin=0.3)
L2 <- Lposterior(chain.wPE.sim2, tree, burnin=.3)
plot(L1$pp, L2$pp, ylab="Simulated data under PE Posterior Probabilities", xlab="Empirical data Posterior Probabilities",
xlim=c(0,1), ylim=c(0,1), pch=21, bg="gray90", cex=1.5)
text(0.85, 0.1, "Phrynosoma")
abline(0,1, lty=2)
plotSimmap.mcmc(chain.wPE, burnin=0.3, pp.cutoff=0.5, pal=colorRampPalette(viridis::viridis(3)[c(1, 2)]))
dev.off()
pdf("~/repos/pnh-ms/R/output/scales/ScalesReanalysis.pdf", height=8, width=12)
par(mfrow=c(2,2), mar=c(5,5,0.25, 0.25))
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(2,3, 1)), fsize=0.75, ylab="FG fraction", xlab="Time (my)")
priorDens <- density(rbeta(length(postburn)*90, 0.8, 0.8), bw=0.01)
plot(priorDens$x, priorDens$y*2000, type="n", lty=2, ylim=c(0, 7000), xlab="Weight to PE Hypothesis", ylab="Density", yaxt="n")
lines(priorDens$x, priorDens$y*1000, lty=2)
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
legend(0, 7000, legend = c("Prior","Scales data", "Simulated data, phrynos only", "Simulated data under PE Hypothesis"),
pch=rep(22,4) , pt.bg=c("black", cols),lty=c(2,NA,NA,NA),  pt.cex=c(0,2,2,2))
L1 <- Lposterior(chain.wPE,tree, burnin=0.3)
L2 <- Lposterior(chain.wPE.sim2, tree, burnin=.3)
plot(L1$pp, L2$pp, ylab="Simulated data under PE Posterior Probabilities", xlab="Empirical data Posterior Probabilities",
xlim=c(0,1), ylim=c(0,1), pch=21, bg="gray90", cex=1.5)
text(0.85, 0.1, "Phrynosoma")
abline(0,1, lty=2)
plotSimmap.mcmc(chain.wPE, burnin=0.3, pp.cutoff=0.5, pal=colorRampPalette(viridis::viridis(3)[c(1, 2)]))
dev.off()
pdf("~/repos/pnh-ms/R/output/scales/ScalesReanalysis.pdf", height=8, width=12)
par(mfrow=c(2,2), mar=c(5,5,0.25, 0.25))
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(2,3, 1)), fsize=0.75, ylab="FG fraction", xlab="Time (my)")
priorDens <- density(rbeta(length(postburn)*90, 0.8, 0.8), bw=0.01)
plot(priorDens$x, priorDens$y*2000, type="n", lty=2, ylim=c(0, 7000), xlab="Weight to PE Hypothesis", ylab="Density", yaxt="n")
lines(priorDens$x[priorDens$x>0 & priorDens$x<1], priorDens$y[priorDens$x>0 & priorDens$x<1]*1000, lty=2)
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
legend(0, 7000, legend = c("Prior","Scales data", "Simulated data, phrynos only", "Simulated data under PE Hypothesis"),
pch=rep(22,4) , pt.bg=c("black", cols),lty=c(2,NA,NA,NA),  pt.cex=c(0,2,2,2))
L1 <- Lposterior(chain.wPE,tree, burnin=0.3)
L2 <- Lposterior(chain.wPE.sim2, tree, burnin=.3)
plot(L1$pp, L2$pp, ylab="Simulated data under PE Posterior Probabilities", xlab="Empirical data Posterior Probabilities",
xlim=c(0,1), ylim=c(0,1), pch=21, bg="gray90", cex=1.5)
text(0.85, 0.1, "Phrynosoma")
abline(0,1, lty=2)
plotSimmap.mcmc(chain.wPE, burnin=0.3, pp.cutoff=0.5, pal=colorRampPalette(viridis::viridis(3)[c(1, 2)]))
dev.off()
pdf("~/repos/pnh-ms/R/output/scales/ScalesReanalysis.pdf", height=8, width=12)
par(mfrow=c(2,2), mar=c(5,5,0.25, 0.25))
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(2,3, 1)), fsize=0.75, ylab="FG fraction", xlab="Time (my)")
priorDens <- density(rbeta(length(postburn)*90, 0.8, 0.8), bw=0.005)
plot(priorDens$x, priorDens$y*2000, type="n", lty=2, ylim=c(0, 7000), xlab="Weight to PE Hypothesis", ylab="Density", yaxt="n")
lines(priorDens$x[priorDens$x>0 & priorDens$x<1], priorDens$y[priorDens$x>0 & priorDens$x<1]*2000, lty=2)
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
legend(0, 7000, legend = c("Prior","Scales data", "Simulated data, phrynos only", "Simulated data under PE Hypothesis"),
pch=rep(22,4) , pt.bg=c("black", cols),lty=c(2,NA,NA,NA),  pt.cex=c(0,2,2,2))
L1 <- Lposterior(chain.wPE,tree, burnin=0.3)
L2 <- Lposterior(chain.wPE.sim2, tree, burnin=.3)
plot(L1$pp, L2$pp, ylab="Simulated data under PE Posterior Probabilities", xlab="Empirical data Posterior Probabilities",
xlim=c(0,1), ylim=c(0,1), pch=21, bg="gray90", cex=1.5)
text(0.85, 0.1, "Phrynosoma")
abline(0,1, lty=2)
plotSimmap.mcmc(chain.wPE, burnin=0.3, pp.cutoff=0.5, pal=colorRampPalette(viridis::viridis(3)[c(1, 2)]))
dev.off()
pdf("~/repos/pnh-ms/R/output/scales/ScalesReanalysis.pdf", height=8, width=12)
par(mfrow=c(2,2), mar=c(5,5,0.25, 0.25))
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(2,3, 1)), fsize=0.75, ylab="FG fraction", xlab="Time (my)")
priorDens <- density(rbeta(length(postburn)*90, 0.8, 0.8), bw=0.005)
plot(priorDens$x, priorDens$y*2000, type="n", lty=2, ylim=c(0, 7000), xlab="Weight to PE Hypothesis", ylab="Density", yaxt="n")
lines(c(0, priorDens$x[priorDens$x>0 & priorDens$x<1], 1), c(0, priorDens$y[priorDens$x>0 & priorDens$x<1]*1500, 0), lty=2)
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
legend(0, 7000, legend = c("Prior","Scales data", "Simulated data, phrynos only", "Simulated data under PE Hypothesis"),
pch=rep(22,4) , pt.bg=c("black", cols),lty=c(2,NA,NA,NA),  pt.cex=c(0,2,2,2))
L1 <- Lposterior(chain.wPE,tree, burnin=0.3)
L2 <- Lposterior(chain.wPE.sim2, tree, burnin=.3)
plot(L1$pp, L2$pp, ylab="Simulated data under PE Posterior Probabilities", xlab="Empirical data Posterior Probabilities",
xlim=c(0,1), ylim=c(0,1), pch=21, bg="gray90", cex=1.5)
text(0.85, 0.1, "Phrynosoma")
abline(0,1, lty=2)
plotSimmap.mcmc(chain.wPE, burnin=0.3, pp.cutoff=0.5, pal=colorRampPalette(viridis::viridis(3)[c(1, 2)]))
dev.off()
pdf("~/repos/pnh-ms/R/output/scales/ScalesReanalysis.pdf", height=8, width=12)
par(mfrow=c(2,2), mar=c(5,5,0.25, 0.25))
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(2,3, 1)), fsize=1, ylab="FG fraction", xlab="Time (my)")
priorDens <- density(rbeta(length(postburn)*90, 0.8, 0.8), bw=0.005)
plot(priorDens$x, priorDens$y*2000, type="n", lty=2, ylim=c(0, 7000), xlab="Weight to PE Hypothesis", ylab="Density", yaxt="n")
lines(c(0, priorDens$x[priorDens$x>0 & priorDens$x<1], 1), c(0, priorDens$y[priorDens$x>0 & priorDens$x<1]*1500, 0), lty=2)
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
legend(0, 7000, legend = c("Prior","Scales data", "Simulated data, phrynos only", "Simulated data under PE Hypothesis"),
pch=rep(22,4) , pt.bg=c("black", cols),lty=c(2,NA,NA,NA),  pt.cex=c(0,2,2,2))
L1 <- Lposterior(chain.wPE,tree, burnin=0.3)
L2 <- Lposterior(chain.wPE.sim2, tree, burnin=.3)
plot(L1$pp, L2$pp, ylab="Simulated data under PE Posterior Probabilities", xlab="Empirical data Posterior Probabilities",
xlim=c(0,1), ylim=c(0,1), pch=21, bg="gray90", cex=1.5)
text(0.85, 0.1, "Phrynosoma")
abline(0,1, lty=2)
plotSimmap.mcmc(chain.wPE, burnin=0.3, pp.cutoff=0.5, pal=colorRampPalette(viridis::viridis(3)[c(1, 2)]))
dev.off()
pdf("~/repos/pnh-ms/R/output/scales/ScalesReanalysis.pdf", height=8, width=12)
par(mfrow=c(2,2), mar=c(5,5,0.25, 0.25))
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(2,3, 1)), fsize=1, ylab="FG fraction", xlab="Time (my)")
priorDens <- density(rbeta(length(postburn)*90, 0.8, 0.8), bw=0.005)
plot(priorDens$x, priorDens$y*2000, type="n", lty=2, ylim=c(0, 7000), xlab="Weight to PE Hypothesis", ylab="Density", yaxt="n")
lines(c(0, priorDens$x[priorDens$x>0 & priorDens$x<1], 1), c(0, priorDens$y[priorDens$x>0 & priorDens$x<1]*1500, 0), lty=2)
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
legend(0, 7000, legend = c("Prior","Scales data", "Simulated data, phrynos only", "Simulated data under PE Hypothesis"),
pch=rep(22,4) , pt.bg=c("black", cols),lty=c(2,NA,NA,NA),  pt.cex=c(0,2,2,2))
L1 <- Lposterior(chain.wPE,tree, burnin=0.3)
L2 <- Lposterior(chain.wPE.sim2, tree, burnin=.3)
plot(L1$pp, L2$pp, ylab="Simulated data under PE Posterior Probabilities", xlab="Empirical data Posterior Probabilities",
xlim=c(0,1), ylim=c(0,1), pch=21, bg="gray90", cex=1.5)
text(0.85, 0.1, "Phrynosoma")
abline(0,1, lty=2)
plotSimmap.mcmc(chain.wPE, burnin=0.3, pp.cutoff=0.5,lwd=2, pal=colorRampPalette(viridis::viridis(3)[c(1, 2)]))
dev.off()
pdf("~/repos/pnh-ms/R/output/scales/ScalesReanalysis.pdf", height=8, width=12)
par(mfrow=c(2,2), mar=c(5,5,0.25, 0.25))
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(2,3, 1)), fsize=1, ylab="FG fraction", xlab="Time (my)")
priorDens <- density(rbeta(length(postburn)*90, 0.8, 0.8), bw=0.005)
plot(priorDens$x, priorDens$y*2000, type="n", lty=2, ylim=c(0, 7000), xlab="Weight to PE Hypothesis", ylab="Density", yaxt="n")
lines(c(0, priorDens$x[priorDens$x>0 & priorDens$x<1], 1), c(0, priorDens$y[priorDens$x>0 & priorDens$x<1]*1500, 0), lty=2)
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
legend(0, 7000, legend = c("Prior","Scales data", "Simulated data, phrynos only", "Simulated data under PE Hypothesis"),
pch=rep(22,4) , pt.bg=c("black", cols),lty=c(2,NA,NA,NA),  pt.cex=c(0,2,2,2))
L1 <- Lposterior(chain.wPE,tree, burnin=0.3)
L2 <- Lposterior(chain.wPE.sim2, tree, burnin=.3)
plot(L1$pp, L2$pp, ylab="Branch posterior prob. for simulated data (PE Hyp)", xlab="Branch posterior prob. for empirical data",
xlim=c(0,1), ylim=c(0,1), pch=21, bg="gray90", cex=1.5)
text(0.85, 0.1, "Phrynosoma")
abline(0,1, lty=2)
plotSimmap.mcmc(chain.wPE, burnin=0.3, pp.cutoff=0.5,lwd=2, pal=colorRampPalette(viridis::viridis(3)[c(1, 2)]))
dev.off()
pdf("~/repos/pnh-ms/R/output/scales/ScalesReanalysis.pdf", height=8, width=12)
par(mfrow=c(2,2), mar=c(5,5,0.5, 0.25))
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(2,3, 1)), fsize=1, ylab="FG fraction", xlab="Time (my)")
priorDens <- density(rbeta(length(postburn)*90, 0.8, 0.8), bw=0.005)
plot(priorDens$x, priorDens$y*2000, type="n", lty=2, ylim=c(0, 7000), xlab="Weight to PE Hypothesis", ylab="Density", yaxt="n")
lines(c(0, priorDens$x[priorDens$x>0 & priorDens$x<1], 1), c(0, priorDens$y[priorDens$x>0 & priorDens$x<1]*1500, 0), lty=2)
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
legend(0, 7000, legend = c("Prior","Scales data", "Simulated data, phrynos only", "Simulated data under PE Hypothesis"),
pch=rep(22,4) , pt.bg=c("black", cols),lty=c(2,NA,NA,NA),  pt.cex=c(0,2,2,2))
L1 <- Lposterior(chain.wPE,tree, burnin=0.3)
L2 <- Lposterior(chain.wPE.sim2, tree, burnin=.3)
plot(L1$pp, L2$pp, ylab="Branch posterior prob. for simulated data (PE Hyp)", xlab="Branch posterior prob. for empirical data",
xlim=c(0,1), ylim=c(0,1), pch=21, bg="gray90", cex=1.5)
text(0.85, 0.1, "Phrynosoma")
abline(0,1, lty=2)
plotSimmap.mcmc(chain.wPE, burnin=0.3, pp.cutoff=0.5,lwd=2, pal=colorRampPalette(viridis::viridis(3)[c(1, 2)]))
dev.off()
pdf("~/repos/pnh-ms/R/output/scales/ScalesReanalysis.pdf", height=8, width=12)
par(mfrow=c(2,2), mar=c(5,5,0.75, 0.25))
phenogram(pars2simmap(H.PE, td$phy)$tr, dat, colors = setNames(viridis::viridis(3), c(2,3, 1)), fsize=1, ylab="FG fraction", xlab="Time (my)")
priorDens <- density(rbeta(length(postburn)*90, 0.8, 0.8), bw=0.005)
plot(priorDens$x, priorDens$y*2000, type="n", lty=2, ylim=c(0, 7000), xlab="Weight to PE Hypothesis", ylab="Density", yaxt="n")
lines(c(0, priorDens$x[priorDens$x>0 & priorDens$x<1], 1), c(0, priorDens$y[priorDens$x>0 & priorDens$x<1]*1500, 0), lty=2)
cols <- sapply(viridis::viridis(3), function(x) bayou:::makeTransparent(x, 50))
hist(1-chain.wPE$w[postburn], col=cols[1], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim1$w[postburn], col=cols[2], add=TRUE, breaks=seq(0,1,0.025))
hist(1-chain.wPE.sim2$w[postburn], col=cols[3], add=TRUE, breaks=seq(0,1,0.025))
legend(0, 7000, legend = c("Prior","Scales data", "Simulated data, phrynos only", "Simulated data under PE Hypothesis"),
pch=rep(22,4) , pt.bg=c("black", cols),lty=c(2,NA,NA,NA),  pt.cex=c(0,2,2,2))
L1 <- Lposterior(chain.wPE,tree, burnin=0.3)
L2 <- Lposterior(chain.wPE.sim2, tree, burnin=.3)
plot(L1$pp, L2$pp, ylab="Branch posterior prob. for simulated data (PE Hyp)", xlab="Branch posterior prob. for empirical data",
xlim=c(0,1), ylim=c(0,1), pch=21, bg="gray90", cex=1.5)
text(0.85, 0.1, "Phrynosoma")
abline(0,1, lty=2)
plotSimmap.mcmc(chain.wPE, burnin=0.3, pp.cutoff=0.5,lwd=2, pal=colorRampPalette(viridis::viridis(3)[c(1, 2)]))
dev.off()
tree
